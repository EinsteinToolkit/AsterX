(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     77033,       1965]
NotebookOptionsPosition[     72864,       1886]
NotebookOutlinePosition[     73516,       1907]
CellTagsIndexPosition[     73473,       1904]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Piece of Cake coordinates", "Title",
 CellChangeTimes->{{3.842480859572761*^9, 3.8424808734034557`*^9}, {
  3.842742869283586*^9, 3.842742878013317*^9}, {3.843003248017685*^9, 
  3.843003253996933*^9}, {3.843838607912539*^9, 
  3.8438386131860456`*^9}},ExpressionUUID->"06cf51ac-2049-45e5-befb-\
5e7a3ea14fb4"],

Cell[CellGroupData[{

Cell["Coordinate system description", "Section",
 CellChangeTimes->{{3.855773081862537*^9, 
  3.855773086192668*^9}},ExpressionUUID->"9579f520-6487-4166-93f9-\
3d52dfaaed63"],

Cell[TextData[{
 "The coordinates used here are based upon \
https://arxiv.org/abs/gr-qc/0512001v1.\nEach patch will use local coordinates \
labeled ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"a", ",", "b", ",", "c"}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "89a6fe49-b057-48bd-baee-d879501aba05"],
 " limited to the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "]"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2f1a7a89-6e31-47d0-92fb-f8d9290e248e"],
 " range and is embedded in a global Cartesian coordinate system with \
coordinates ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"x", ",", "y", ",", "z"}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1bd5ddbc-7d0b-42c6-9ef9-e018ca45a581"],
 ".  The ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ddaca7aa-12f1-48a0-9161-14808956f370"],
 " coordinate is radial while the remaining two are angular. The ",
 Cell[BoxData[
  FormBox[
   RowBox[{"+", "x"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ca311297-dec8-4f62-b277-da856ecb45d7"],
 " patch is defined and all other patches are rotations of it."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQrfvGeovvrjeOVx5pbwXRepOy2v2AtMDmHV0gOu7o
9N0gOumX5l4Q/aaV6SqItrd4eANEZ0ztewaiP39KfQWiFX5+FPEH0g9i5MRA
dN1sHSsQPe3cPUcQ7XH2RRGIjmk5UAqitY58eQGie3JKvoDoihP/QwJA9tbV
hYLotu6TpSC69k5GDYhe+0amF0R/4/89CUQ7M/TNBNE1x9png+gb36QWgGil
i+vAtEhCxxIQbbDi4FIQ3WR6ZhWIPj+xeA2ItnGKkw4E0reezAPTrMZxGiD6
wNM9xiDaJi47DUTvEJTOBNENTZKzg0D2rBNZCKL3XJv+FkRvufLuM4jW+jBB
MBhIF2zbCqYBDJTB5g==
  
  "],ExpressionUUID->"6b97c8f2-ddfa-476d-b0bf-a5e6f3eadff9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Patch system skeleton", "Section",
 CellChangeTimes->{{3.8448108646711617`*^9, 3.844810871321*^9}, {
  3.845641104146451*^9, 3.845641105656435*^9}, {3.8456414906301517`*^9, 
  3.845641495240016*^9}, {3.845641576798369*^9, 
  3.845641578368043*^9}},ExpressionUUID->"601eacfc-d37b-4778-b351-\
75911fbad235"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "CakePlusX", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CakePlusX", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"baseX", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"baseY", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"baseZ", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "CakeMinusX", "]"}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CakeMinusX", "=", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"\[Pi]", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
     "CakePlusX"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "CakePlusY", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CakePlusY", "=", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
     "CakePlusX"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "CakeMinusY", "]"}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CakeMinusY", "=", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
     "CakePlusX"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "CakePlusZ", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CakePlusZ", "=", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ".", 
     "CakePlusX"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "CakeMinusZ", "]"}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CakeMinusZ", "=", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ".", 
     "CakePlusX"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "InverseCakePlusX", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InverseCakePlusX", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"baseA", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"baseB", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"baseC", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "InverseCakeMinusX", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InverseCakeMinusX", "=", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"\[Pi]", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
     "InverseCakePlusX"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "InverseCakePlusY", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InverseCakePlusY", "=", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
     "InverseCakePlusX"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "InverseCakeMinusY", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InverseCakeMinusY", "=", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
     "InverseCakePlusX"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "InverseCakePlusZ", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InverseCakePlusZ", "=", 
    RowBox[{
     RowBox[{"RotationMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ".", 
     "InverseCakePlusX"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "InverseCakeMinusZ", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InverseCakeMinusZ", "=", 
   RowBox[{
    RowBox[{"RotationMatrix", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "2"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ".", 
    "InverseCakePlusX"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.844432718702897*^9, 3.844432723490147*^9}, {
   3.844433003156488*^9, 3.844433027865608*^9}, {3.8444330937849827`*^9, 
   3.8444331069452744`*^9}, {3.8444332271426497`*^9, 
   3.8444333036133537`*^9}, {3.844433367962267*^9, 3.84443338179132*^9}, {
   3.844434003260775*^9, 3.844434030999547*^9}, {3.8444349425299797`*^9, 
   3.844434947688848*^9}, {3.844437113018725*^9, 3.844437116197493*^9}, {
   3.844437180747018*^9, 3.844437206146435*^9}, {3.844437684536944*^9, 
   3.844437764755073*^9}, {3.844438089981491*^9, 3.844438101659445*^9}, {
   3.844443350154336*^9, 3.844443354553878*^9}, 3.84444579101473*^9, 
   3.84444590438314*^9, {3.844446058899844*^9, 3.8444461060191927`*^9}, {
   3.844457535066834*^9, 3.844457591975732*^9}, {3.8444579741957607`*^9, 
   3.844458003434993*^9}, 3.844458249267202*^9, 3.844458294072276*^9, 
   3.844458367908342*^9, {3.844458398437764*^9, 3.8444584334594316`*^9}, {
   3.844458470739402*^9, 3.8444584733883657`*^9}, {3.844458596140977*^9, 
   3.844458600392589*^9}, {3.844458751570125*^9, 3.84445882387059*^9}, {
   3.8444594706433973`*^9, 3.844459474363484*^9}, {3.844810146956689*^9, 
   3.8448101877093067`*^9}, {3.84481045029561*^9, 3.844810493598917*^9}, {
   3.844810608559704*^9, 3.8448106316768827`*^9}, {3.844811023159759*^9, 
   3.844811023409419*^9}, {3.8456409139815474`*^9, 3.845640917190625*^9}, {
   3.845641109157414*^9, 3.8456411174383307`*^9}, {3.845641377892755*^9, 
   3.845641447331727*^9}, {3.845641505021315*^9, 3.845641567398898*^9}, {
   3.855784326894327*^9, 3.8557843272308807`*^9}, {3.855784406268498*^9, 
   3.8557844867461443`*^9}, {3.8557846396915703`*^9, 3.855784656878216*^9}, {
   3.856989776211707*^9, 3.856989778690833*^9}, {3.8569902072950363`*^9, 
   3.856990209882496*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"186ffb67-217b-4d86-ae44-abe7bc14f2bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Base Coordinate transformations", "Section",
 CellChangeTimes->{{3.845644776513996*^9, 
  3.8456447811240377`*^9}},ExpressionUUID->"28125e6d-7567-46e8-bdea-\
e105700b528e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"baseX", ",", "baseY", ",", "baseZ"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"baseX", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"r0", 
      RowBox[{"(", 
       RowBox[{"1", "-", "c"}], ")"}]}], "+", 
     RowBox[{"r1", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]}], 
    SqrtBox[
     RowBox[{"4", "+", 
      RowBox[{"2", 
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}], "+", 
      RowBox[{"2", 
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]}]]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"baseY", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "=", 
   RowBox[{"b", "*", 
    RowBox[{"baseX", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"baseZ", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "=", 
    RowBox[{"a", "*", 
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"baseA", ",", "baseA", ",", "baseA"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"baseC", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     SuperscriptBox["r0", "2"], "-", 
     SuperscriptBox["r1", "2"], "+", 
     SuperscriptBox["y", "2"], "+", 
     SuperscriptBox["z", "2"], "+", 
     SqrtBox[
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["r1", "2"], " ", 
        SuperscriptBox["x", "2"]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], "2"], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["r0", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], "-", 
       RowBox[{"4", " ", "r0", " ", "r1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["x", "2"]}], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}]}]]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"r0", "-", "r1"}], ")"}], "2"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"baseB", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   RowBox[{"y", "/", "x"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"baseA", "[", 
    RowBox[{"x_", ",", "y_", ",", "c_"}], "]"}], "=", 
   RowBox[{"z", "/", "x"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.845685995498473*^9, 3.8456860213183527`*^9}, {
   3.845686092678422*^9, 3.845686095376782*^9}, {3.8457426756233673`*^9, 
   3.845742685782091*^9}, {3.845976895694695*^9, 3.845976967461896*^9}, {
   3.846084312082247*^9, 3.8460843284206867`*^9}, {3.8474899559526253`*^9, 
   3.847489957401607*^9}, {3.855677492210058*^9, 3.855677518495707*^9}, {
   3.8557821387356977`*^9, 3.85578218470478*^9}, 3.855782981161112*^9, {
   3.8557831904274*^9, 3.8557831979057198`*^9}, {3.855784017504313*^9, 
   3.855784026390643*^9}, {3.85578449830157*^9, 3.855784527301095*^9}, {
   3.855784595669726*^9, 3.8557846101890793`*^9}, {3.855784673781878*^9, 
   3.855784741067087*^9}, {3.8557852048433437`*^9, 3.85578520857868*^9}, 
   3.855785832817123*^9, {3.8557859350261087`*^9, 3.855785936513648*^9}, {
   3.855785995944268*^9, 3.8557860018838577`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ccc13385-1f22-4f6c-9748-5297dd2c96be"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualising patches", "Section",
 CellChangeTimes->{{3.844435585166781*^9, 3.844435593302009*^9}, {
  3.8445549493435793`*^9, 3.844554956443583*^9}, {3.845641615498287*^9, 
  3.845641616388297*^9}},ExpressionUUID->"68753264-36b0-49e8-ad42-\
f2e3dfb3bef2"],

Cell[CellGroupData[{

Cell["3D Patch Plotting routine", "Subsection",
 CellChangeTimes->{{3.84445919434982*^9, 3.8444591990600557`*^9}, {
   3.8456416188473454`*^9, 3.845641619438048*^9}, 
   3.845756750405403*^9},ExpressionUUID->"6a8d20ab-5293-432a-a1c8-\
84ffc7c18ec5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "AssertAbort", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AssertAbort", "[", 
     RowBox[{"cond_", ",", "msg_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"cond", "\[Equal]", "False"}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "msg", "]"}], ";", 
       RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "PlotPatch3D", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotPatch3D", "[", 
    RowBox[{
    "color_", ",", "patchName_", ",", "R0_", ",", "Rf_", ",", "surface_"}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r0", "=", "R0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"r1", "=", "Rf"}], ",", "\[IndentingNewLine]", 
       RowBox[{"c", "=", "surface"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertAbort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "\[LessEqual]", "surface", "\[LessEqual]", "1"}],
         ",", "\"\<The surface parameter must be inside the (-1,1) interval\>\
\""}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{"ParametricPlot3D", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Evaluate", "[", "patchName", "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"MaxRecursion", "\[Rule]", "2"}], ",", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"BoundaryStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", "color"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"MeshStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thin"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"MeshFunctions", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z", ",", "b", ",", "c"}], "}"}], 
              ",", "c"}], "]"}], ",", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z", ",", "b", ",", "c"}], "}"}], 
              ",", "b"}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.844459222130837*^9, 3.844459222496002*^9}, {
  3.8444594067827168`*^9, 3.844459407851962*^9}, {3.844553048164133*^9, 
  3.844553092943398*^9}, {3.8448068320945873`*^9, 3.8448068398186483`*^9}, {
  3.8448071048679047`*^9, 3.844807105548386*^9}, {3.844811948695006*^9, 
  3.844811989833351*^9}, {3.845640846673156*^9, 3.84564088522663*^9}, {
  3.8456409715009537`*^9, 3.8456409803304977`*^9}, {3.855782250446303*^9, 
  3.855782288904591*^9}, {3.855782389103546*^9, 3.855782398562379*^9}, {
  3.8557828590539713`*^9, 3.8557828620334387`*^9}, {3.855783361844849*^9, 
  3.855783364954023*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"b0caefbf-4efd-4dec-bbed-6cb54483c02f"]
}, Closed]],

Cell[CellGroupData[{

Cell["3D Plots", "Subsection",
 CellChangeTimes->{{3.84455507703155*^9, 3.844555077811494*^9}, {
  3.845644906692103*^9, 
  3.845644907462111*^9}},ExpressionUUID->"e8c9fab4-ce89-49de-a119-\
c39fff2e2d62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "R0", ",", "Rf"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"c", "=", "cval"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"R0", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rf", "=", "10"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PlotPatch3D", "[", 
         RowBox[{"Red", ",", "CakePlusX", ",", "R0", ",", "Rf", ",", "c"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotPatch3D", "[", 
         RowBox[{"Green", ",", "CakeMinusX", ",", "R0", ",", "Rf", ",", "c"}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotPatch3D", "[", 
         RowBox[{"Blue", ",", "CakePlusY", ",", "R0", ",", "Rf", ",", "c"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotPatch3D", "[", 
         RowBox[{
         "Orange", ",", "CakeMinusY", ",", "R0", ",", "Rf", ",", "c"}], "]"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"PlotPatch3D", "[", 
         RowBox[{"Yellow", ",", "CakePlusZ", ",", "R0", ",", "Rf", ",", "c"}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotPatch3D", "[", 
         RowBox[{"White", ",", "CakeMinusZ", ",", "R0", ",", "Rf", ",", "c"}],
          "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Rf"}], ",", "Rf"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Rf"}], ",", "Rf"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Rf"}], ",", "Rf"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]"}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Boxed", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<c=\>\"", "<>", 
          RowBox[{"ToString", "[", "c", "]"}]}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"cval", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.844433386742107*^9, 3.8444335115494967`*^9}, {
   3.844433555350939*^9, 3.844433567029646*^9}, {3.844433603568359*^9, 
   3.8444336281522284`*^9}, {3.84443367911423*^9, 3.844433720148038*^9}, {
   3.844433750806875*^9, 3.844433843005603*^9}, {3.8444347809815207`*^9, 
   3.8444347818048067`*^9}, {3.844435602666459*^9, 3.844435664820607*^9}, {
   3.844435848453459*^9, 3.844435960332459*^9}, {3.844436004229219*^9, 
   3.844436016449741*^9}, {3.84443619908188*^9, 3.844436218261302*^9}, {
   3.844436335998316*^9, 3.8444363428827457`*^9}, 3.8444366968738413`*^9, {
   3.8444367349844513`*^9, 3.8444367661811237`*^9}, {3.844436808246468*^9, 
   3.8444368607165613`*^9}, {3.844437162661783*^9, 3.844437162719531*^9}, {
   3.844438264390184*^9, 3.84443835111617*^9}, {3.844438391758374*^9, 
   3.844438409074272*^9}, {3.844439076535222*^9, 3.8444392813331823`*^9}, {
   3.844439320431596*^9, 3.844439346830884*^9}, {3.844439578178977*^9, 
   3.844439630974822*^9}, {3.844439839628141*^9, 3.844439849924378*^9}, {
   3.844440213855658*^9, 3.8444402297739487`*^9}, {3.844440265463863*^9, 
   3.84444030000135*^9}, {3.844441050139038*^9, 3.844441058188212*^9}, {
   3.844441099889578*^9, 3.8444411076793137`*^9}, {3.844441152438222*^9, 
   3.844441172207941*^9}, {3.844441220115716*^9, 3.8444412330483513`*^9}, 
   3.844441274306355*^9, {3.8444413317886868`*^9, 3.844441334493348*^9}, {
   3.844441397458166*^9, 3.844441407171391*^9}, {3.844441442922819*^9, 
   3.8444414522017517`*^9}, {3.844441493670035*^9, 3.844441548178967*^9}, {
   3.84444159586979*^9, 3.844441639726631*^9}, {3.84444168598695*^9, 
   3.844441703146371*^9}, {3.844442005130567*^9, 3.844442014541469*^9}, {
   3.844442507546826*^9, 3.844442643666*^9}, {3.844442783968905*^9, 
   3.844442819958591*^9}, {3.8444428611882257`*^9, 3.844442866216464*^9}, {
   3.8444432316892548`*^9, 3.844443239269094*^9}, {3.844443312897274*^9, 
   3.844443335386812*^9}, {3.844443628253414*^9, 3.8444436289288473`*^9}, {
   3.844443777458089*^9, 3.844443850154499*^9}, {3.844443894416573*^9, 
   3.844443894983142*^9}, {3.8444439411666393`*^9, 3.8444439417531147`*^9}, {
   3.844444105022149*^9, 3.844444204349955*^9}, 3.844444244151546*^9, {
   3.844444320661846*^9, 3.8444444643883877`*^9}, {3.844444552708767*^9, 
   3.844444655194051*^9}, {3.844444699253703*^9, 3.844444760308196*^9}, {
   3.844444795390503*^9, 3.844444831744686*^9}, {3.844445120540847*^9, 
   3.8444451224174128`*^9}, 3.844445454744084*^9, {3.844445547199781*^9, 
   3.844445622011569*^9}, {3.844445680691598*^9, 3.8444457359194927`*^9}, 
   3.844445865276765*^9, {3.8444592446236067`*^9, 3.8444593844307737`*^9}, {
   3.844459419203783*^9, 3.844459433500951*^9}, {3.844459482953166*^9, 
   3.8444595613714647`*^9}, {3.844459795191551*^9, 3.844459816462234*^9}, {
   3.844460080743908*^9, 3.8444601200623493`*^9}, {3.844460336412175*^9, 
   3.844460372713722*^9}, 3.8444604099546833`*^9, {3.8444605566643333`*^9, 
   3.8444605650324183`*^9}, {3.844460607974218*^9, 3.8444606245313883`*^9}, {
   3.844460719565331*^9, 3.8444607496820993`*^9}, {3.844461030972809*^9, 
   3.844461048631706*^9}, 3.844461261206354*^9, {3.844461581082712*^9, 
   3.844461582420046*^9}, 3.844461645245757*^9, 3.844461710178898*^9, {
   3.844462013997355*^9, 3.844462016216695*^9}, {3.84446239727177*^9, 
   3.8444624149300528`*^9}, {3.844462738358032*^9, 3.844462742497053*^9}, 
   3.844463051240213*^9, {3.84446311209897*^9, 3.844463123006514*^9}, {
   3.844463402166389*^9, 3.844463406225912*^9}, {3.8444634928739557`*^9, 
   3.844463494093287*^9}, {3.8444635273620453`*^9, 3.844463560270419*^9}, {
   3.8444636086796494`*^9, 3.844463610978574*^9}, {3.8444636498902273`*^9, 
   3.844463677928656*^9}, {3.844463802124586*^9, 3.844463812931196*^9}, {
   3.844463923309293*^9, 3.84446416767752*^9}, {3.844464203718379*^9, 
   3.844464274401423*^9}, {3.844552966717383*^9, 3.844552971145705*^9}, {
   3.844553113973225*^9, 3.8445531385431767`*^9}, {3.844553186942088*^9, 
   3.844553207140884*^9}, {3.844553638553527*^9, 3.844553638851117*^9}, 
   3.844553715231824*^9, {3.844553874387971*^9, 3.844553881857954*^9}, {
   3.844554270929502*^9, 3.844554347307061*^9}, {3.844554617812192*^9, 
   3.844554696212324*^9}, {3.844796769372037*^9, 3.844796802435254*^9}, {
   3.844796868982641*^9, 3.8447968698820972`*^9}, {3.844796995126342*^9, 
   3.8447969983459377`*^9}, {3.8448068450076933`*^9, 3.844806848056775*^9}, {
   3.8448071622185802`*^9, 3.8448071634463387`*^9}, {3.844809712354866*^9, 
   3.8448097287359324`*^9}, {3.8448098061843433`*^9, 3.844809806532029*^9}, {
   3.8448098488630657`*^9, 3.8448098640827703`*^9}, {3.8448102175552797`*^9, 
   3.8448102231746693`*^9}, 3.844810512420759*^9, {3.844810824095648*^9, 
   3.84481083087392*^9}, {3.8448110432510433`*^9, 3.84481106624117*^9}, {
   3.844811466535132*^9, 3.844811517931013*^9}, {3.844811556793187*^9, 
   3.844811569551776*^9}, {3.844811923562525*^9, 3.844811937406176*^9}, {
   3.844812003854437*^9, 3.844812014101877*^9}, {3.844988874894081*^9, 
   3.844988922172489*^9}, {3.84498968259993*^9, 3.844989803134863*^9}, {
   3.844989960874135*^9, 3.844989992207398*^9}, {3.844990060283485*^9, 
   3.844990074024901*^9}, {3.844990124490469*^9, 3.844990165180356*^9}, {
   3.844990457865822*^9, 3.8449904955030746`*^9}, {3.844991519300419*^9, 
   3.8449915285209837`*^9}, {3.844991565868845*^9, 3.8449918071248426`*^9}, {
   3.844991857366415*^9, 3.84499186966667*^9}, {3.844991942434279*^9, 
   3.8449919555415173`*^9}, {3.844991988984404*^9, 3.8449920870088167`*^9}, {
   3.844992277577483*^9, 3.844992387702477*^9}, {3.844992435383895*^9, 
   3.8449926364808493`*^9}, {3.84499267906065*^9, 3.844992719747348*^9}, 
   3.8449927607586193`*^9, {3.8455913706622868`*^9, 3.8455913729704657`*^9}, {
   3.8455914058737383`*^9, 3.845591407921492*^9}, {3.845640795066401*^9, 
   3.845640815957775*^9}, {3.845641134771164*^9, 3.8456411377800007`*^9}, {
   3.845641192708955*^9, 3.8456412104989977`*^9}, {3.845641247459786*^9, 
   3.8456412483776913`*^9}, {3.845641291607679*^9, 3.845641343344762*^9}, {
   3.845641459355741*^9, 3.8456414602957373`*^9}, {3.84564151784433*^9, 
   3.845641543483506*^9}, {3.845641583801881*^9, 3.845641597981777*^9}, {
   3.845641668104949*^9, 3.8456416683691807`*^9}, {3.845641725561778*^9, 
   3.845641730416689*^9}, {3.845644918636818*^9, 3.845644923823409*^9}, {
   3.845645384277597*^9, 3.845645394393412*^9}, 3.845646249362927*^9, {
   3.845686076658484*^9, 3.8456860821962767`*^9}, {3.845743114514558*^9, 
   3.845743167983604*^9}, {3.845977012634226*^9, 3.845977024204073*^9}, 
   3.84597793171878*^9, {3.855782528040552*^9, 3.85578254738842*^9}, 
   3.8557825816797743`*^9, {3.8557828687550983`*^9, 3.855782873132332*^9}, {
   3.855782935243937*^9, 3.855782963269979*^9}, {3.855783210536923*^9, 
   3.855783234325459*^9}, 3.855783544261343*^9, {3.855784050742611*^9, 
   3.855784051270446*^9}, {3.855784096131907*^9, 3.8557842439495*^9}, {
   3.85689276401439*^9, 3.856892813379603*^9}, {3.856892853949798*^9, 
   3.8568930789797697`*^9}, {3.856893159705166*^9, 3.856893188783927*^9}, {
   3.8569118555603447`*^9, 3.856911863002091*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"7c539802-9fb4-42ba-8475-b4674e9add84"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`cval$$ = 1., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`cval$$], -1, 1}}, Typeset`size$$ = {
    576., {293., 296.9130434782609}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`cval$$ = -1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Block[{$CellContext`c, $CellContext`R0, $CellContext`Rf}, \
$CellContext`c = $CellContext`cval$$; $CellContext`R0 = 1; $CellContext`Rf = 
         10; Show[
          $CellContext`PlotPatch3D[
          Red, $CellContext`CakePlusX, $CellContext`R0, $CellContext`Rf, \
$CellContext`c], 
          $CellContext`PlotPatch3D[
          Green, $CellContext`CakeMinusX, $CellContext`R0, $CellContext`Rf, \
$CellContext`c], 
          $CellContext`PlotPatch3D[
          Blue, $CellContext`CakePlusY, $CellContext`R0, $CellContext`Rf, \
$CellContext`c], 
          $CellContext`PlotPatch3D[
          Orange, $CellContext`CakeMinusY, $CellContext`R0, $CellContext`Rf, \
$CellContext`c], 
          $CellContext`PlotPatch3D[
          Yellow, $CellContext`CakePlusZ, $CellContext`R0, $CellContext`Rf, \
$CellContext`c], 
          $CellContext`PlotPatch3D[
          White, $CellContext`CakeMinusZ, $CellContext`R0, $CellContext`Rf, \
$CellContext`c], 
          PlotRange -> {{-$CellContext`Rf, $CellContext`Rf}, \
{-$CellContext`Rf, $CellContext`Rf}, {-$CellContext`Rf, $CellContext`Rf}}, 
          AxesLabel -> {"x", "y", "z"}, 
          ViewPoint -> {Infinity, Infinity, Infinity}, Axes -> False, Boxed -> 
          False, ImageSize -> Large, PlotLabel -> StringJoin["c=", 
            ToString[$CellContext`c]]]], 
      "Specifications" :> {{$CellContext`cval$$, -1, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{623., {337.73641304347825`, 343.26358695652175`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.856893090035254*^9, 3.856893117576318*^9}, {
   3.856893153716138*^9, 3.856893189302067*^9}, {3.856911510668026*^9, 
   3.8569115178761253`*^9}, 3.856911865425655*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"b4ec6c3f-ba12-4277-b20b-4d967f22e6e1"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Code output", "Section",
 CellChangeTimes->{{3.8569698407757597`*^9, 
  3.8569698543756113`*^9}},ExpressionUUID->"b34d4070-2bd5-42e9-a64e-\
2cee4fd68fd1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "rationalPowerToSqrt", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rationalPowerToSqrt", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"y_", ",", 
       RowBox[{"Rational", "[", 
        RowBox[{"x_", ",", "2"}], "]"}]}], "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"HoldForm", "[", "y", "]"}], ",", 
         RowBox[{
          RowBox[{"Sign", "[", "x", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Abs", "[", "x", "]"}], "-", "2"}], ")"}]}]}], "]"}], 
       RowBox[{"Power", "[", 
        RowBox[{"y", ",", 
         RowBox[{"Rational", "[", 
          RowBox[{
           RowBox[{"Sign", "[", "x", "]"}], ",", "2"}], "]"}]}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"Abs", "[", "x", "]"}], "\[NotEqual]", "1"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.856969872915327*^9, 3.8569699078098993`*^9}, 
   3.8569701100844927`*^9, 3.8569701458918962`*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"62682d17-0bee-4cd2-8cfa-17445646792b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "a"}], "]"}], "//.", 
   "rationalPowerToSqrt"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], "//.", 
   "rationalPowerToSqrt"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], "//.", 
   "rationalPowerToSqrt"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.856970117533104*^9, 3.856970154316004*^9}, {
  3.856970306678474*^9, 3.856970354835622*^9}, {3.8569711234114027`*^9, 
  3.8569711255710793`*^9}, {3.856972850305503*^9, 3.856972858788185*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"29a586b7-e182-4b87-b86c-57bec604a97b"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"r0", "-", 
      RowBox[{"c", " ", "r0"}], "+", "r1", "+", 
      RowBox[{"c", " ", "r1"}]}], ")"}]}], 
   RowBox[{
    SqrtBox[
     RowBox[{"4", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]}]], " ", 
    RowBox[{"(", 
     TagBox[
      RowBox[{"4", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "c"}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "c"}], ")"}]}]}],
      HoldForm], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.856970129815835*^9, 3.856970154790574*^9}, {
   3.856970312241795*^9, 3.85697035514834*^9}, {3.856972852171776*^9, 
   3.856972858983437*^9}, 3.8569733927440243`*^9, {3.8569761267001762`*^9, 
   3.856976144467512*^9}},
 CellLabel->"Out[11]=",ExpressionUUID->"17ffec7a-fe82-449f-8a46-7fe651387ac5"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "b", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"r0", "-", 
      RowBox[{"c", " ", "r0"}], "+", "r1", "+", 
      RowBox[{"c", " ", "r1"}]}], ")"}]}], 
   RowBox[{
    SqrtBox[
     RowBox[{"4", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]}]], " ", 
    RowBox[{"(", 
     TagBox[
      RowBox[{"4", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "c"}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "c"}], ")"}]}]}],
      HoldForm], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.856970129815835*^9, 3.856970154790574*^9}, {
   3.856970312241795*^9, 3.85697035514834*^9}, {3.856972852171776*^9, 
   3.856972858983437*^9}, 3.8569733927440243`*^9, {3.8569761267001762`*^9, 
   3.85697614449793*^9}},
 CellLabel->"Out[12]=",ExpressionUUID->"1427afc8-ba3d-49e7-a9cc-f06be9344e00"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "r0"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", "r1"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "r0"}], "+", "r1"}], ")"}], " ", 
    RowBox[{"(", 
     TagBox[
      RowBox[{"4", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "c"}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "c"}], ")"}]}]}],
      HoldForm], ")"}]}]}], 
  RowBox[{
   SqrtBox["2"], " ", 
   SqrtBox[
    RowBox[{"2", "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]}]], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{"4", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]}],
     HoldForm], ")"}]}]]], "Output",
 CellChangeTimes->{{3.856970129815835*^9, 3.856970154790574*^9}, {
   3.856970312241795*^9, 3.85697035514834*^9}, {3.856972852171776*^9, 
   3.856972858983437*^9}, 3.8569733927440243`*^9, {3.8569761267001762`*^9, 
   3.85697614458375*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"37d69080-9d9a-43ec-87b3-05f4c93cc777"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "a", ",", "a"}], "]"}], "//.",
    "rationalPowerToSqrt"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "a", ",", "b"}], "]"}], "//.",
    "rationalPowerToSqrt"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "a", ",", "c"}], "]"}], "//.",
    "rationalPowerToSqrt"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b", ",", "b"}], "]"}], "//.",
    "rationalPowerToSqrt"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b", ",", "c"}], "]"}], "//.",
    "rationalPowerToSqrt"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c", ",", "c"}], "]"}], "//.",
    "rationalPowerToSqrt"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.856971131101162*^9, 3.856971133121262*^9}, {
   3.85697147027553*^9, 3.8569714840744123`*^9}, {3.856971786348765*^9, 
   3.85697179242832*^9}, {3.8569718383385*^9, 3.856971855536804*^9}, 
   3.856972678030898*^9, 3.856972719669815*^9, {3.856974350465662*^9, 
   3.856974362263739*^9}, {3.856977195062503*^9, 3.856977197872685*^9}, {
   3.856977321670013*^9, 3.856977324359651*^9}, {3.856977580014921*^9, 
   3.856977587704739*^9}, {3.856977755381998*^9, 3.856977757101613*^9}, {
   3.856977914819145*^9, 3.856977916708807*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"79aa159f-bdf2-4689-bc38-00ee843d6508"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SqrtBox["2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "r0"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", "r1"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        TagBox[
         RowBox[{"4", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "c"}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "c"}], ")"}]}]}],
         HoldForm], ")"}], "2"]}], ")"}]}], 
   RowBox[{
    SqrtBox[
     RowBox[{"2", "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      TagBox[
       RowBox[{"4", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "c"}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "c"}], ")"}]}]}],
       HoldForm], ")"}], "3"]}]]}]], "Output",
 CellChangeTimes->{
  3.8569711346192017`*^9, 3.8569711665030537`*^9, {3.8569714786625347`*^9, 
   3.856971484834395*^9}, 3.856971793057262*^9, {3.85697183975196*^9, 
   3.856971855889798*^9}, 3.856972678613925*^9, 3.856972720085928*^9, 
   3.856974362772187*^9, 3.856977198163306*^9, 3.8569773437126827`*^9, 
   3.8569775903692217`*^9, 3.8569777574318647`*^9, 3.85697791725076*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"28d3f7de-92bb-40fd-bbea-86d24139f753"],

Cell[BoxData[
 FractionBox[
  RowBox[{"12", " ", "a", " ", "b", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"r0", "-", 
     RowBox[{"c", " ", "r0"}], "+", "r1", "+", 
     RowBox[{"c", " ", "r1"}]}], ")"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"4", "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     TagBox[
      RowBox[{"4", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "c"}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "c"}], ")"}]}]}],
      HoldForm], ")"}], "3"]}]]], "Output",
 CellChangeTimes->{
  3.8569711346192017`*^9, 3.8569711665030537`*^9, {3.8569714786625347`*^9, 
   3.856971484834395*^9}, 3.856971793057262*^9, {3.85697183975196*^9, 
   3.856971855889798*^9}, 3.856972678613925*^9, 3.856972720085928*^9, 
   3.856974362772187*^9, 3.856977198163306*^9, 3.8569773437126827`*^9, 
   3.8569775903692217`*^9, 3.8569777574318647`*^9, 3.856977917252861*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"8455782f-6e28-49b2-a954-fccfe56429ac"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SqrtBox["2"], " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "r0"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "c"}], ")"}], " ", "r1"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"r1", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "r0"}], "+", "r1"}], ")"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         TagBox[
          RowBox[{"4", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "c"}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "c"}], ")"}]}]}],
          HoldForm], ")"}], "2"]}]}], ")"}]}], 
   RowBox[{
    SqrtBox[
     RowBox[{"2", "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      TagBox[
       RowBox[{"4", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "c"}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "c"}], ")"}]}]}],
       HoldForm], ")"}], "3"]}]]}]], "Output",
 CellChangeTimes->{
  3.8569711346192017`*^9, 3.8569711665030537`*^9, {3.8569714786625347`*^9, 
   3.856971484834395*^9}, 3.856971793057262*^9, {3.85697183975196*^9, 
   3.856971855889798*^9}, 3.856972678613925*^9, 3.856972720085928*^9, 
   3.856974362772187*^9, 3.856977198163306*^9, 3.8569773437126827`*^9, 
   3.8569775903692217`*^9, 3.8569777574318647`*^9, 3.8569779172561502`*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"5ccc543e-16ab-459c-a189-8252ad9bfc7f"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SqrtBox["2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "r0"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", "r1"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        TagBox[
         RowBox[{"4", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "c"}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "c"}], ")"}]}]}],
         HoldForm], ")"}], "2"]}], ")"}]}], 
   RowBox[{
    SqrtBox[
     RowBox[{"2", "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      TagBox[
       RowBox[{"4", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "c"}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "c"}], ")"}]}]}],
       HoldForm], ")"}], "3"]}]]}]], "Output",
 CellChangeTimes->{
  3.8569711346192017`*^9, 3.8569711665030537`*^9, {3.8569714786625347`*^9, 
   3.856971484834395*^9}, 3.856971793057262*^9, {3.85697183975196*^9, 
   3.856971855889798*^9}, 3.856972678613925*^9, 3.856972720085928*^9, 
   3.856974362772187*^9, 3.856977198163306*^9, 3.8569773437126827`*^9, 
   3.8569775903692217`*^9, 3.8569777574318647`*^9, 3.856977917259283*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"9b038f09-9bbc-40b1-853c-83fb4be521bd"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SqrtBox["2"], " ", "b", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "r0"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "c"}], ")"}], " ", "r1"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"r1", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "r0"}], "+", "r1"}], ")"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         TagBox[
          RowBox[{"4", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "c"}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "c"}], ")"}]}]}],
          HoldForm], ")"}], "2"]}]}], ")"}]}], 
   RowBox[{
    SqrtBox[
     RowBox[{"2", "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      TagBox[
       RowBox[{"4", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "c"}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "c"}], ")"}]}]}],
       HoldForm], ")"}], "3"]}]]}]], "Output",
 CellChangeTimes->{
  3.8569711346192017`*^9, 3.8569711665030537`*^9, {3.8569714786625347`*^9, 
   3.856971484834395*^9}, 3.856971793057262*^9, {3.85697183975196*^9, 
   3.856971855889798*^9}, 3.856972678613925*^9, 3.856972720085928*^9, 
   3.856974362772187*^9, 3.856977198163306*^9, 3.8569773437126827`*^9, 
   3.8569775903692217`*^9, 3.8569777574318647`*^9, 3.85697791726227*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"eaf1ac35-5ea3-4e66-8d6d-faea46a972bd"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["a", "2"], "+", 
     SuperscriptBox["b", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["b", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "r0"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "c"}], ")"}], " ", "r1"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"r0", "-", "r1"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        TagBox[
         RowBox[{"4", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "c"}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "c"}], ")"}]}]}],
         HoldForm], ")"}], "2"]}]}], ")"}]}], 
  RowBox[{
   SqrtBox["2"], " ", 
   SqrtBox[
    RowBox[{"2", "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     TagBox[
      RowBox[{"4", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "c"}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "c"}], ")"}]}]}],
      HoldForm], ")"}], "3"]}]]], "Output",
 CellChangeTimes->{
  3.8569711346192017`*^9, 3.8569711665030537`*^9, {3.8569714786625347`*^9, 
   3.856971484834395*^9}, 3.856971793057262*^9, {3.85697183975196*^9, 
   3.856971855889798*^9}, 3.856972678613925*^9, 3.856972720085928*^9, 
   3.856974362772187*^9, 3.856977198163306*^9, 3.8569773437126827`*^9, 
   3.8569775903692217`*^9, 3.8569777574318647`*^9, 3.8569779173918667`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"2b04173c-338b-4af4-bb4c-e5d879df34ff"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jacobians and code generation", "Section",
 CellChangeTimes->{{3.844820628414963*^9, 
  3.8448206376849527`*^9}},ExpressionUUID->"aac8c2de-1705-4e11-82a7-\
d37ddc3603ca"],

Cell[TextData[{
 "Recall the our global to local transformations are\n\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"baseX", "(", 
     RowBox[{"a", ",", "b", ",", "c"}], ")"}], "=", 
    RowBox[{"core", "(", 
     RowBox[{"a", ",", "b", ",", "c"}], ")"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"baseY", "(", 
     RowBox[{"a", ",", "b", ",", "c"}], ")"}], "=", 
    RowBox[{"b", "*", 
     RowBox[{"baseX", "(", 
      RowBox[{"a", ",", "b", ",", "c"}], ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"baseZ", "(", 
      RowBox[{"a", ",", "b", ",", "c"}], ")"}], "=", 
     RowBox[{"c", "*", 
      RowBox[{"baseX", "(", 
       RowBox[{"a", ",", "b", ",", "c"}], ")"}]}]}], ","}], TraditionalForm]}],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7245bf71-9245-4309-a427-d709b662c0e1"],
 "\n\nwhere\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"core", "(", 
     RowBox[{"a", ",", "b", ",", "c"}], ")"}], "=", 
    FractionBox[
     RowBox[{"f", "-", 
      RowBox[{"a", " ", "f"}], "+", "Rf", "+", 
      RowBox[{"a", " ", "Rf"}]}], 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox[
       RowBox[{"2", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "a"}], ")"}], " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "a"}], ")"}], " ", 
         SuperscriptBox["c", "2"]}]}]]}]]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "76a4e254-d6cb-4c72-b832-809191d98fea"],
 "\n\nThus all derivatives can be computed in terms of the core function."
}], "Text",
 CellChangeTimes->{{3.8460843424597054`*^9, 
  3.846084494466394*^9}},ExpressionUUID->"a1dc3eef-aba1-46f5-8810-\
b875ef843746"],

Cell[CellGroupData[{

Cell["Jacobians", "Subsection",
 CellChangeTimes->{{3.8445552053486977`*^9, 
  3.844555208478395*^9}},ExpressionUUID->"18cb78ab-aff5-45ba-904e-\
2df71596b815"],

Cell["\<\
Since all patches are rotations of the +X patch, we compute derivatives only \
once\
\>", "Text",
 CellChangeTimes->{{3.844555210628648*^9, 3.844555247088414*^9}, {
   3.844555351006609*^9, 3.8445553522964773`*^9}, {3.844821048970983*^9, 
   3.8448210546409283`*^9}, 
   3.8457567404159603`*^9},ExpressionUUID->"d50bc171-0b20-4e4f-aec3-\
ee94f88f3257"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"baseX", ",", "baseY", ",", "baseZ"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"baseX", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"core", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"baseY", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"b", "*", 
    RowBox[{"baseX", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"baseZ", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
    RowBox[{"c", "*", 
     RowBox[{"baseX", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"coords", ",", "functions", ",", "functionsName"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coords", "=", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"functions", "=", "CakePlusZ"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"functionsName", "=", "\"\<CAKE_PLUS_Z\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "derivativeRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"derivativeRules", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"core", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "a"}], "]"}], ",", 
         "CForm"}], "]"}], "\[Rule]", "\"\<d_core_da\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"core", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b"}], "]"}], ",", 
         "CForm"}], "]"}], "\[Rule]", "\"\<d_core_db\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"core", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "c"}], "]"}], ",", 
         "CForm"}], "]"}], "\[Rule]", "\"\<d_core_dc\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"core", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "2"}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
       "\[Rule]", "\"\<d2_core_da_da\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"core", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "2"}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
       "\[Rule]", "\"\<d2_core_db_db\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"core", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "2"}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
       "\[Rule]", "\"\<d2_core_dc_dc\>\""}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"core", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "a", ",", "b"}], 
          "]"}], ",", "CForm"}], "]"}], "\[Rule]", "\"\<d2_core_da_db\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"core", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "a", ",", "c"}], 
          "]"}], ",", "CForm"}], "]"}], "\[Rule]", "\"\<d2_core_da_dc\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"core", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "b", ",", "c"}], 
          "]"}], ",", "CForm"}], "]"}], "\[Rule]", "\"\<d2_core_db_dc\>\""}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"core", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "CForm"}], "]"}], 
       "\[Rule]", "\"\<core\>\""}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "J", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"da", "/", 
     RowBox[{"dx", "[", 
      RowBox[{"i", ",", "j"}], "]"}]}], "=", 
    RowBox[{
     RowBox[{"da", "[", "i", "]"}], "/", 
     RowBox[{"dx", "[", "j", "]"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
       "functions", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
       "coords", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "dJ", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "^", "2"}], 
     RowBox[{"a", "/", 
      RowBox[{"dx", "^", 
       RowBox[{"2", "[", 
        RowBox[{"i", ",", "j", ",", "k"}], "]"}]}]}]}], "=", 
    RowBox[{
     RowBox[{"d", "^", "2"}], 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "/", 
      RowBox[{"dx", "^", 
       RowBox[{"2", "[", 
        RowBox[{"j", ",", "k"}], "]"}]}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dJ", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
       "functions", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
       "coords", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], ",", 
       
       RowBox[{
       "coords", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Transform", " ", "to", " ", "code"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{"\"\<stdout\>\"", ",", 
   RowBox[{
   "\"\<#define \>\"", "<>", "functionsName", "<>", "\"\<_JACOBIAN \>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "3"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", "3"}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WriteString", "[", 
       RowBox[{"\"\<stdout\>\"", ",", 
        RowBox[{"\"\<J(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<)(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<) = \>\"", "<>", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{"J", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", "CForm"}], "]"}], ",", 
           "derivativeRules"}], "]"}], "<>", "\"\<;\>\""}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"\"\<stdout\>\"", ",", "\"\<\\n\\n\>\""}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{"\"\<stdout\>\"", ",", 
   RowBox[{
   "\"\<#define \>\"", "<>", "functionsName", "<>", "\"\<_DJACOBIAN \>\""}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "3"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", "3"}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", "3"}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"\"\<stdout\>\"", ",", 
          RowBox[{"\"\<dJ(\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<)(\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"j", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"k", "-", "1"}], "]"}], "<>", "\"\<) = \>\"", "<>", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"dJ", "[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", "CForm"}], 
              "]"}], ",", "derivativeRules"}], "]"}], "<>", "\"\<;\>\""}]}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.844555357035696*^9, 3.8445554177649097`*^9}, {
   3.844556093364773*^9, 3.844556268527671*^9}, {3.844556302037595*^9, 
   3.844556523115862*^9}, {3.844556557584216*^9, 3.844556568642921*^9}, {
   3.844556632020903*^9, 3.8445568569192142`*^9}, {3.844556906565702*^9, 
   3.844557006933517*^9}, {3.84455710890423*^9, 3.844557268051888*^9}, {
   3.844557299730859*^9, 3.844557346522697*^9}, {3.8445573846499653`*^9, 
   3.844557412931323*^9}, {3.84455747066789*^9, 3.844557773022596*^9}, {
   3.844557819467043*^9, 3.844557850158593*^9}, {3.844807631897707*^9, 
   3.8448076401246853`*^9}, {3.844811630490754*^9, 3.844811668368103*^9}, {
   3.844811705550363*^9, 3.84481173011215*^9}, {3.844820578828603*^9, 
   3.844820610905693*^9}, {3.844820662210389*^9, 3.844820949033586*^9}, {
   3.844820987633822*^9, 3.8448209958438663`*^9}, {3.846085109002692*^9, 
   3.846085149199314*^9}, {3.846085207619639*^9, 3.846085216068761*^9}, {
   3.84608527879944*^9, 3.846085327525758*^9}, {3.846085362496022*^9, 
   3.846085555016239*^9}, {3.846085587676421*^9, 3.846085645704603*^9}, {
   3.846086056143278*^9, 3.846086150227625*^9}, {3.846086292712928*^9, 
   3.846086490521125*^9}, {3.846086521052518*^9, 3.846086714063286*^9}, {
   3.846086815351478*^9, 3.8460869212278214`*^9}, {3.846086993127885*^9, 
   3.84608702566888*^9}, {3.846087077316272*^9, 3.8460871509049683`*^9}, {
   3.846104797035263*^9, 3.846104858396845*^9}, {3.846108203757223*^9, 
   3.84610823454438*^9}, 3.846108738259192*^9, {3.8461088062585363`*^9, 
   3.846108814986484*^9}, {3.846109241179256*^9, 3.846109307470105*^9}, {
   3.847412858593297*^9, 3.847412860731786*^9}, {3.847493243406959*^9, 
   3.847493253374833*^9}, {3.8478128237117968`*^9, 3.847812851737204*^9}, {
   3.847812913116078*^9, 3.84781292495599*^9}, {3.8478130683825693`*^9, 
   3.8478130805553417`*^9}, {3.847813144493271*^9, 3.8478131450215178`*^9}, {
   3.847813343369372*^9, 3.8478133522873783`*^9}, {3.847885156700234*^9, 
   3.847885173510014*^9}, {3.847885441828433*^9, 3.84788548040362*^9}, {
   3.847885517222659*^9, 3.847885571601021*^9}, {3.847885603515306*^9, 
   3.847885616300325*^9}, {3.847885750998674*^9, 3.847885786837125*^9}, {
   3.847885861900317*^9, 3.84788588603617*^9}, {3.847885935636855*^9, 
   3.847885937675232*^9}, {3.8478862139853783`*^9, 3.84788624454066*^9}, {
   3.8478862974914637`*^9, 3.8478863834584208`*^9}, {3.847886656293826*^9, 
   3.84788667987364*^9}, {3.847886742992503*^9, 3.8478867660715523`*^9}, {
   3.847886809113501*^9, 3.847886812340938*^9}, {3.8478868533318872`*^9, 
   3.8478868537702503`*^9}, {3.847886892773367*^9, 3.8478868939863253`*^9}, {
   3.847886941283746*^9, 3.847886989170039*^9}, {3.847887044819384*^9, 
   3.847887194215908*^9}, 3.847887472869638*^9},
 CellLabel->
  "In[533]:=",ExpressionUUID->"a3c3d996-7249-49f2-a713-17b132aece98"],

Cell["\<\
#define CAKE_PLUS_Z_JACOBIAN J(0)(0) = -(c*d_core_da);J(0)(1) = \
-(c*d_core_db);J(0)(2) = -core - c*d_core_dc;J(1)(0) = b*d_core_da;J(1)(1) = \
core + b*d_core_db;J(1)(2) = b*d_core_dc;J(2)(0) = d_core_da;J(2)(1) = \
d_core_db;J(2)(2) = d_core_dc;

#define CAKE_PLUS_Z_DJACOBIAN dJ(0)(0,0) = -(c*d2_core_da_da);dJ(0)(0,1) = \
-(c*d2_core_da_db);dJ(0)(0,2) = -d_core_da - c*d2_core_da_dc;dJ(0)(1,0) = \
-(c*d2_core_da_db);dJ(0)(1,1) = -(c*d2_core_db_db);dJ(0)(1,2) = -d_core_db - \
c*d2_core_db_dc;dJ(0)(2,0) = -d_core_da - c*d2_core_da_dc;dJ(0)(2,1) = \
-d_core_db - c*d2_core_db_dc;dJ(0)(2,2) = -2*d_core_dc - \
c*d2_core_dc_dc;dJ(1)(0,0) = b*d2_core_da_da;dJ(1)(0,1) = d_core_da + \
b*d2_core_da_db;dJ(1)(0,2) = b*d2_core_da_dc;dJ(1)(1,0) = d_core_da + \
b*d2_core_da_db;dJ(1)(1,1) = 2*d_core_db + b*d2_core_db_db;dJ(1)(1,2) = \
d_core_dc + b*d2_core_db_dc;dJ(1)(2,0) = b*d2_core_da_dc;dJ(1)(2,1) = \
d_core_dc + b*d2_core_db_dc;dJ(1)(2,2) = b*d2_core_dc_dc;dJ(2)(0,0) = \
d2_core_da_da;dJ(2)(0,1) = d2_core_da_db;dJ(2)(0,2) = \
d2_core_da_dc;dJ(2)(1,0) = d2_core_da_db;dJ(2)(1,1) = \
d2_core_db_db;dJ(2)(1,2) = d2_core_db_dc;dJ(2)(2,0) = \
d2_core_da_dc;dJ(2)(2,1) = d2_core_db_dc;dJ(2)(2,2) = d2_core_dc_dc;\
\>", "Print",
 CellChangeTimes->{
  3.8478859443254128`*^9, {3.847886221859542*^9, 3.847886246588395*^9}, {
   3.8478863034727087`*^9, 3.847886340222043*^9}, {3.847886745796322*^9, 
   3.8478867665562897`*^9}, 3.847886813142591*^9, 3.847886854265486*^9, 
   3.84788689445996*^9, 3.8478869445398483`*^9, 3.8478870102766333`*^9, 
   3.847887072299182*^9, {3.847887110341757*^9, 3.847887144891137*^9}, {
   3.847887176066309*^9, 3.847887194708063*^9}, 3.847887474910719*^9},
 CellLabel->
  "During evaluation of \
In[533]:=",ExpressionUUID->"6f485ea3-22b9-4cca-8558-02ddc0ac4e53"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["Scratch space", "Section",
 CellChangeTimes->{{3.8450394900745583`*^9, 
  3.8450394924345093`*^9}},ExpressionUUID->"1b57e1d4-3b3b-411e-b897-\
61cd0262d9ba"]
}, Open  ]]
},
WindowSize->{1502.608695652174, 788.0869565217392},
WindowMargins->{{1502.608695652174, Automatic}, {
  Automatic, 22.945054945054945`}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
DefaultNaturalLanguage->Language,
FrontEndVersion->"12.1 for Linux x86 (64-bit) (June 19, 2020)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"c7c54479-860f-4a9a-bc66-0ea79160d210"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 316, 5, 103, "Title",ExpressionUUID->"06cf51ac-2049-45e5-befb-5e7a3ea14fb4"],
Cell[CellGroupData[{
Cell[921, 31, 174, 3, 73, "Section",ExpressionUUID->"9579f520-6487-4166-93f9-3d52dfaaed63"],
Cell[1098, 36, 1815, 48, 89, "Text",ExpressionUUID->"6b97c8f2-ddfa-476d-b0bf-a5e6f3eadff9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2950, 89, 311, 5, 73, "Section",ExpressionUUID->"601eacfc-d37b-4778-b351-75911fbad235"],
Cell[3264, 96, 7279, 188, 904, "Input",ExpressionUUID->"186ffb67-217b-4d86-ae44-abe7bc14f2bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10580, 289, 178, 3, 73, "Section",ExpressionUUID->"28125e6d-7567-46e8-bdea-e105700b528e"],
Cell[10761, 294, 3866, 108, 264, "Input",ExpressionUUID->"ccc13385-1f22-4f6c-9748-5297dd2c96be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14664, 407, 261, 4, 73, "Section",ExpressionUUID->"68753264-36b0-49e8-ad42-f2e3dfb3bef2"],
Cell[CellGroupData[{
Cell[14950, 415, 249, 4, 37, "Subsection",ExpressionUUID->"6a8d20ab-5293-432a-a1c8-84ffc7c18ec5"],
Cell[15202, 421, 4277, 94, 760, "Input",ExpressionUUID->"b0caefbf-4efd-4dec-bbed-6cb54483c02f"]
}, Closed]],
Cell[CellGroupData[{
Cell[19516, 520, 204, 4, 37, "Subsection",ExpressionUUID->"e8c9fab4-ce89-49de-a119-c39fff2e2d62"],
Cell[CellGroupData[{
Cell[19745, 528, 10239, 165, 596, "Input",ExpressionUUID->"7c539802-9fb4-42ba-8475-b4674e9add84"],
Cell[29987, 695, 3046, 61, 707, "Output",ExpressionUUID->"b4ec6c3f-ba12-4277-b20b-4d967f22e6e1"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33094, 763, 160, 3, 73, "Section",ExpressionUUID->"b34d4070-2bd5-42e9-a64e-2cee4fd68fd1"],
Cell[33257, 768, 1164, 32, 61, "Input",ExpressionUUID->"62682d17-0bee-4cd2-8cfa-17445646792b"],
Cell[CellGroupData[{
Cell[34446, 804, 999, 25, 82, "Input",ExpressionUUID->"29a586b7-e182-4b87-b86c-57bec604a97b"],
Cell[35448, 831, 1276, 37, 62, "Output",ExpressionUUID->"17ffec7a-fe82-449f-8a46-7fe651387ac5"],
Cell[36727, 870, 1275, 37, 63, "Output",ExpressionUUID->"1427afc8-ba3d-49e7-a9cc-f06be9344e00"],
Cell[38005, 909, 1858, 61, 67, "Output",ExpressionUUID->"37d69080-9d9a-43ec-87b3-05f4c93cc777"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39900, 975, 2100, 51, 144, "Input",ExpressionUUID->"79aa159f-bdf2-4689-bc38-00ee843d6508"],
Cell[42003, 1028, 2151, 65, 68, "Output",ExpressionUUID->"28d3f7de-92bb-40fd-bbea-86d24139f753"],
Cell[44157, 1095, 1446, 40, 65, "Output",ExpressionUUID->"8455782f-6e28-49b2-a954-fccfe56429ac"],
Cell[45606, 1137, 2451, 73, 68, "Output",ExpressionUUID->"5ccc543e-16ab-459c-a189-8252ad9bfc7f"],
Cell[48060, 1212, 2152, 65, 68, "Output",ExpressionUUID->"9b038f09-9bbc-40b1-853c-83fb4be521bd"],
Cell[50215, 1279, 2448, 73, 68, "Output",ExpressionUUID->"eaf1ac35-5ea3-4e66-8d6d-faea46a972bd"],
Cell[52666, 1354, 2311, 71, 67, "Output",ExpressionUUID->"2b04173c-338b-4af4-bb4c-e5d879df34ff"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55026, 1431, 176, 3, 73, "Section",ExpressionUUID->"aac8c2de-1705-4e11-82a7-d37ddc3603ca"],
Cell[55205, 1436, 1839, 56, 301, "Text",ExpressionUUID->"a1dc3eef-aba1-46f5-8810-b875ef843746"],
Cell[CellGroupData[{
Cell[57069, 1496, 159, 3, 37, "Subsection",ExpressionUUID->"18cb78ab-aff5-45ba-904e-2df71596b815"],
Cell[57231, 1501, 362, 8, 37, "Text",ExpressionUUID->"d50bc171-0b20-4e4f-aec3-ee94f88f3257"],
Cell[CellGroupData[{
Cell[57618, 1513, 13225, 330, 1132, "Input",ExpressionUUID->"a3c3d996-7249-49f2-a713-17b132aece98"],
Cell[70846, 1845, 1801, 30, 58, "Print",ExpressionUUID->"6f485ea3-22b9-4cca-8558-02ddc0ac4e53"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[72686, 1880, 162, 3, 73, "Section",ExpressionUUID->"1b57e1d4-3b3b-411e-b897-61cd0262d9ba"]
}, Open  ]]
}
]
*)

